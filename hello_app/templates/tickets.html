{% extends "main.html" %}
{% load static %}

{% block main %}
<section class="tickets-section">
    <div class="container">
        <h1>Купить билеты</h1>
        <p>Выберите концерт и забронируйте места</p>

        {% for concert in concerts %}
        <div id="{{ concert.artist.name|slugify }}" class="concert-card">
            <div class="concert-image">
                <img src="{{ concert.artist.image }}" alt="{{ concert.artist.name }}">
            </div>
            
            <div class="concert-info">
                <h3 class="concert-title">{{ concert.artist.name }}</h3>
                
                <div class="concert-details">
                    <div class="detail-item">
                        <span class="detail-icon"></span>
                        {{ concert.venue.city }}, {{ concert.venue.name }}
                    </div>
                    <div class="detail-item">
                        <span class="detail-icon"></span>
                        {{ concert.start_time|date:"d E Y" }} • {{ concert.start_time|time:"H:i" }}
                    </div>
                </div>
                
                <div class="price-tag">
                    <strong class="price-amount">
                        Цена: от {{ concert.get_min_price }} ₽
                    </strong>
                </div>
            </div>
            
            <div class="ticket-form">
                <form action="{% url 'buy_ticket' concert.id %}" method="POST">
                    {% csrf_token %}
                    <input type="text" name="name" placeholder="Имя" required class="form-input">
                    <input type="email" name="email" placeholder="Email" required class="form-input">
                    <input type="tel" name="phone" placeholder="Телефон" required class="form-input">
                    
                    <select name="ticket_type" class="form-input" required>
                        <option value="">Выберите тип билета</option>
                        <option value="dancefloor">Танцпол</option>
                        <option value="fan-zone">Фан-зона</option>
                        <option value="vip">VIP</option>
                    </select>
                    
                    <select name="ticket_id" class="form-input" required>
                        <option value="">Выберите категорию билета</option>
                        {% for ticket in concert.ticket_set.all %}
                        <option value="{{ ticket.id }}">
                            {{ ticket.category_id.name }} - {{ ticket.price }} ₽ (доступно: {{ ticket.quantity }})
                        </option>
                        {% endfor %}
                    </select>
                    
                    <select name="quantity" class="form-input" required>
                        <option value="">Количество билетов</option>
                        <option value="1">1 билет</option>
                        <option value="2">2 билета</option>
                        <option value="3">3 билета</option>
                        <option value="4">4 билета</option>
                        <option value="5">5 билетов</option>
                    </select>
                    
                    <button type="submit" class="submit-btn">Забронировать билеты</button>
                </form>
            </div>
        </div>
        {% endfor %}
    </div>
</section>
{% endblock %}